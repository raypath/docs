<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IR RayTracer: NOTES</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IR RayTracer
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">IRRayTracingwithOptix</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">NOTES </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>** Simulation Observations Log</p>
<p>** 4th November 2020</p><ul>
<li>Unable set single wavenumber calcs. Code appers to work only for atleast two wave numbers.</li>
<li>For now playing with 7x7 grid. Both plume and body, plume only and body only runs showed body only run gives negative irradiance at pixel 25 (rowwize) and the rest are all zero.</li>
<li>Difference between Both Plume and body case to plume only case is not equal to bdy only case. Some thing happens when plume is not run at all.</li>
<li>Also, even with combined simulation, 26th pixel irradiance data is three orders of magnitude larger than other pixels. Why is this.</li>
</ul>
<p>** 15th November 2020</p><ul>
<li>Lot of changes to code in terms of thread allocation logic And irradiance min max caluclation normalization, the output pretty much has not changed except for the scale factor of 1/1e-3</li>
<li>While removal of stride logic makes it easy to follow, does not permit serialization when block size required exceeds the allowable limits. But for our case it is not an issue.</li>
<li>Major Milestone Reached Today: Showed that new code and old code give exactly same results with single ray runs. But for multiple rays with parallel threads some rays give same answer but other different ... clearly the artifact of some unidentified error in parallelization. The two codes only differ in thread allocations.. Need further investigaton.</li>
<li>Established both codes give results that are invariant with thread block size one chooses. This experiment was done with 7x7 image, with 2 wave numbers, for blksize(16,32,...512)</li>
<li>Runs with different waveband range 2000-2005 and 3000-3005 showed old and new code irradaiance did not match. However, the ratio of old to new code values seems unchanged for the above two cases ... corresponding to each camera position.</li>
<li>Why do I get these warning with my new code but old code does not. This is the part where it is trying to solve viewfactor. Compared with old code no real change except I have constant multiplier 1.0e3 with postfix f removed [[ rtBody.icu(100): warning: invalid narrowing conversion from "double" to "float" rtBody.icu(101): warning: invalid narrowing conversion from "double" to "float" ]]</li>
<li>Figured that rtBody.icu kernel is never used. So problem is else where. fixed above warning with simple variable assignments.</li>
<li>After fixing the sign issue in body Irradiation calc, and typo introduced error in my code related to solid_angle ( multiplier * was , and this resulted in rest of the expression being ignored as compiler warned ... but was not noticed by me.</li>
<li>Anyway,, now old code and new code results correspond ... with body only runs for both single pixel and multipixel runs</li>
<li>Runs with plume only however, correspond well with single pixel runs, but differe with multipixel runs. In fact, new code gives terribly large IRR value at some pixel. (almost 4 orders of magnitude different to old code. Time to to run single cell run to make sure cell wise calcs are consistent.</li>
<li>After a long saga ... digging deep into the radiation code, understood the reason for above trend. All of the runs I have been trying with the image plane in side the plume. When the first hit distance from emanating ray is very short which it is most likely radiant flux will be large. The reason we don't see with old code is probably because the thread implementation itself is very buggy, it failed to give correct results with single cube of gas mix with one cell. Where as my code give consistent results at various pixel results.</li>
<li>Well I try viewing plume from outside I still have this issue. Why I made sure I was few meters away (~15m). Why are we having issues. Weird. More digging.</li>
<li>Finally figured out issue. A goof in storing the plume hit pixel indicies after first pass on host side that are subsequently needed in second pass. Now things are looking up.</li>
<li>Did two simulations on plume with camera pointing along the axis of plume and another from side of the plume at different pixel resolutions. Images look consistent. Time to validate actual numbers with fortran counter part. Meanwhile, trying higher resolutions along entire plume pushing the device memory limits becuase of lots of plume hits. Need to address this. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
